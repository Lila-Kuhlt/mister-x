name: CI

on:
  pull_request:
    branches:
      - master
  push:
    branches:
      - master
      
env:
  CARGO_TERM_COLOR: always

jobs:
  robusta:
    name: ðŸ¦€ robusta Check & Build
    runs-on: ubuntu-latest
    steps:
      - name: Checkout sources
        uses: actions/checkout@v4
        
      - name: Change directory
        run: cd robusta
        
      - uses: actions/cache@v3
        with:
          path: target
          key: ${{ runner.os }}-robusta-mister-x

      - name: ðŸš§ Build robusta
        run: cargo build
          
      - name: ðŸ”¬ Check formatting
        run: cargo fmt --all -- --check


  liberica:
    name: âš¡ liberica Check & Build
    runs-on: ubuntu-latest
    steps:
      - name: Checkout sources
        uses: actions/checkout@v4
        
      - uses: actions/cache@v3
        with:
          path: liberica/node_modules
          key: ${{ runner.os }}-liberica-mister-x
        
      - name: ðŸš§ Setup bun
        uses: oven-sh/setup-bun@v1
        
      - name: Change directory
        run: cd liberica

      - name: ðŸš§ Install dependencies
        run: bun install

      - name: ðŸ”Ž Lint liberica
        run: bun lint
