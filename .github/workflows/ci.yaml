name: CI

on:
  - pull_request
  - push

env:
  CARGO_TERM_COLOR: always

jobs:
  robusta:
    name: ðŸ¦€ robusta Check & Build
    runs-on: ubuntu-latest
    steps:
      - name: Checkout sources
        uses: actions/checkout@v4

      - uses: actions/cache@v3
        with:
          path: target
          key: ${{ runner.os }}-robusta-mister-x

      - name: ðŸ”¬ Rust fmt
        run: cargo fmt --check --all

      - name: ðŸ”¨ Build robusta
        run: cargo build


  liberica:
    name: âš¡ liberica Check
    runs-on: ubuntu-latest

    defaults:
      run:
        working-directory: liberica

    steps:
      - name: Checkout sources
        uses: actions/checkout@v4

      - uses: actions/cache@v3
        with:
          path: liberica/node_modules
          key: ${{ runner.os }}-liberica-mister-x

      - name: ðŸš§ Setup bun
        uses: oven-sh/setup-bun@v1

      - name: ðŸš§ Install dependencies
        run: bun install

      - name: ðŸ”¨ Build liberica
        run: bun run build

      - name: ðŸ”Ž Lint liberica
        run: bun lint
